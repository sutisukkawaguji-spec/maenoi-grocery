<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ ‚Äî ‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏≥</title>
  <meta name="description" content="‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏≥: ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡πÅ‡∏ä‡∏ï‡∏™‡∏±‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô LINE" />

  <!-- Fonts + Tailwind -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- PapaParse (‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå .txt/.csv) -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <!-- PWA / Icons -->
  <link rel="icon" href="images/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" href="images/icon-192.png">
  <link rel="apple-touch-icon" href="images/icon-192.png">
  <meta name="theme-color" content="#10b981">
  <link rel="manifest" href="manifest.webmanifest">

  <!-- Social -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ ‚Äî ‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏≥‡πÉ‡∏Å‡∏•‡πâ‡∏ö‡πâ‡∏≤‡∏ô">
  <meta property="og:description" content="‡∏Å‡∏î‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏´‡∏¢‡∏¥‡∏ö‡πÉ‡∏™‡πà‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏≤‡∏á LINE ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ">
  <meta property="og:image" content="images/cover.jpg">
  <meta property="og:url" content="">
  <meta property="og:locale" content="th_TH">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ">
  <meta name="twitter:description" content="‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ + ‡πÅ‡∏ä‡∏ï‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ú‡πà‡∏≤‡∏ô LINE">
  <meta name="twitter:image" content="images/cover.jpg">

  <style>
    body { font-family: 'Noto Sans Thai', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif; }
    .card:hover { transform: translateY(-2px); }
    button, a { touch-action: manipulation; }
    @media (max-width: 480px){
      .card h3 { font-size: 0.95rem; }
      #productGrid { gap: 0.6rem; }
    }
    .drawer { position: fixed; top: 0; right: -100%; width: 100%; max-width: 420px; height: 100%;
      background: #fff; box-shadow: -8px 0 24px rgba(0,0,0,.1); transition: right .28s ease;
      z-index: 60; display: flex; flex-direction: column; }
    .drawer.open { right: 0; }
    .backdrop { position: fixed; inset: 0; background: rgba(0,0,0,.35); backdrop-filter: blur(1px);
      z-index: 50; opacity: 0; pointer-events: none; transition: opacity .2s ease; }
    .backdrop.show { opacity: 1; pointer-events: all; }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Header -->
  <header class="sticky top-0 z-40 bg-white/80 backdrop-blur border-b border-gray-200">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center gap-3">
      <img src="images/logo.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ" class="w-10 h-10 rounded-xl object-cover">
      <div>
        <h1 class="text-lg font-semibold leading-tight">‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏≥</h1>
        <p class="text-xs text-gray-500">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡πÅ‡∏ä‡∏ï‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ú‡πà‡∏≤‡∏ô LINE</p>
      </div>

      <div class="ms-auto flex items-center gap-2">
        <a id="lineLink" href="#" target="_blank" class="hidden md:inline-flex items-center gap-2 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
          <img src="https://cdn-icons-png.flaticon.com/512/2111/2111390.png" class="w-4 h-4" alt=""> ‡πÅ‡∏ä‡∏ï‡∏ú‡πà‡∏≤‡∏ô LINE
        </a>
        <button id="openCart" class="relative inline-flex items-center gap-2 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
          üß∫ ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
          <span id="cartBadge" class="absolute -top-2 -right-2 min-w-[22px] h-[22px] px-1 rounded-full bg-emerald-600 text-white text-xs flex items-center justify-center">0</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Top Banner Slider -->
  <section class="relative bg-white">
    <div id="slider" class="relative max-w-6xl mx-auto">
      <div id="slides" class="overflow-hidden rounded-none md:rounded-xl">
        <div class="flex transition-transform duration-500 ease-out" style="transform: translateX(0%)">
          <!-- ‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (‡∏õ‡∏£‡∏±‡∏ö/‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô BANNERS ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ) -->
          <img src="images/banner4.jpg" alt="‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô 1" class="w-full h-64 md:h-96 object-cover flex-shrink-0" loading="lazy">
          <img src="images/banner2.jpg" alt="‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô 2" class="w-full h-64 md:h-96 object-cover flex-shrink-0" loading="lazy">
          <img src="images/banner3.jpg" alt="‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô 3" class="w-full h-64 md:h-96 object-cover flex-shrink-0" loading="lazy">
        </div>
      </div>

      <!-- Arrows -->
      <button id="prevBtn" class="absolute left-2 top-1/2 -translate-y-1/2 bg-black/40 hover:bg-black/60 text-white w-8 h-8 rounded-full grid place-items-center">‚Äπ</button>
      <button id="nextBtn" class="absolute right-2 top-1/2 -translate-y-1/2 bg-black/40 hover:bg-black/60 text-white w-8 h-8 rounded-full grid place-items-center">‚Ä∫</button>

      <!-- Dots -->
      <div id="dots" class="absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-2"></div>
    </div>
  </section>

  <main class="max-w-6xl mx-auto px-4 py-6">
    <!-- Filters -->
    <section class="mb-5 grid grid-cols-1 md:grid-cols-12 gap-3">
      <div class="md:col-span-6">
        <label class="text-sm text-gray-600">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
        <input id="searchInput" type="search" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏≤‡∏°‡πà‡∏≤ ‡∏ô‡∏° UHT..." class="mt-1 w-full px-4 py-2.5 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-emerald-500" />
      </div>
      <div class="md:col-span-3">
        <label class="text-sm text-gray-600">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
        <select id="categorySelect" class="mt-1 w-full px-4 py-2.5 rounded-xl border border-gray-300 bg-white focus:outline-none focus:ring-2 focus:ring-emerald-500">
          <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
        </select>
      </div>
      <div class="md:col-span-3">
        <label class="text-sm text-gray-600">‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤</label>
        <div class="mt-1 flex items-center gap-2">
          <input id="minPrice" type="number" min="0" inputmode="numeric" placeholder="‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î" class="w-full px-4 py-2.5 rounded-xl border border-gray-300 focus:ring-2 focus:ring-emerald-500" />
          <span class="text-gray-400">-</span>
          <input id="maxPrice" type="number" min="0" inputmode="numeric" placeholder="‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î" class="w-full px-4 py-2.5 rounded-xl border border-gray-300 focus:ring-2 focus:ring-emerald-500" />
        </div>
      </div>
    </section>

    <!-- Stats -->
    <section class="mb-4 text-sm text-gray-600 flex items-center gap-3">
      <span id="resultCount">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
      <span class="hidden md:inline">‚Ä¢</span>
      <button id="clearFilters" class="text-emerald-700 hover:underline">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</button>
    </section>

    <!-- Product Grid -->
    <section id="productGrid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4"></section>
  </main>

  <!-- Footer -->
  <footer class="border-t border-gray-200 py-10 text-center text-sm bg-white">
    <h3 class="text-lg font-semibold mb-2 text-emerald-700">‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ</h3>
    <p class="text-gray-600">üè† ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ ‡∏ï‡∏≥‡∏ö‡∏•‡∏•‡∏≥‡∏†‡∏π ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π 39000</p>
    <p class="text-gray-600 mt-1">
      üìû ‡πÇ‡∏ó‡∏£: <a href="tel:0880699227" class="text-emerald-700 hover:underline">088-069-9227</a>
    </p>

    <div class="flex items-center justify-center gap-3 mt-3">
      <!-- Facebook (‡πÉ‡∏ä‡πâ page URL ‡∏Ç‡∏≠‡∏á‡∏û‡∏µ‡πà; ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ Page ID ‡πÉ‡∏ä‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå https://facebook.com/801626436372815 ‡πÅ‡∏ó‡∏ô‡πÑ‡∏î‡πâ) -->
      <a href="https://www.facebook.com/profile.php?id=61582683385650"
        target="_blank" rel="noopener"
        class="inline-flex items-center gap-1 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
        <img src="https://cdn-icons-png.flaticon.com/512/124/124010.png" class="w-4 h-4" alt="Facebook"> Facebook
      </a>

      <!-- LINE -->
      <a id="lineLinkFooter" href="#" target="_blank" rel="noopener"
        class="inline-flex items-center gap-1 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
        <img src="https://cdn-icons-png.flaticon.com/512/2111/2111390.png" class="w-4 h-4" alt="LINE"> LINE
      </a>

      <!-- PromptPay -->
      <button type="button"
              onclick="document.getElementById('qrModal').showModal()"
              class="inline-flex items-center gap-1 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
        <img src="https://cdn-icons-png.flaticon.com/512/1042/1042339.png" class="w-4 h-4" alt="PromptPay"> PromptPay
      </button>
    </div>

    <p class="mt-6 text-gray-400 text-xs">¬© <span id="y"></span> ‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ ‚Äî ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</p>
  </footer>

  <!-- Modal QR PromptPay -->
  <dialog id="qrModal" class="p-0 rounded-2xl shadow-2xl">
    <div class="p-4 bg-white rounded-2xl">
      <h3 class="text-center text-lg font-semibold mb-2">PromptPay</h3>
      <!-- ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏à‡∏±‡∏ï‡∏∏‡∏£‡∏±‡∏™ (Tailwind ‡πÑ‡∏°‡πà‡∏°‡∏µ h-160 ‡πÉ‡∏ô‡∏ä‡∏∏‡∏î default) -->
      <img src="images/promptpay.png" alt="QR PromptPay"
          class="w-80 h-140 mx-auto border rounded-lg object-contain">
      <p class="text-center text-gray-600 mt-2">‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
      <div class="text-center mt-3">
        <button type="button" onclick="document.getElementById('qrModal').close()"
                class="text-emerald-700 hover:underline text-sm">‡∏õ‡∏¥‡∏î</button>
      </div>
    </div>
  </dialog>


  <!-- Floating Chat Button (mobile) -->
  <a id="fabChat" class="fixed bottom-4 right-4 z-50 px-4 py-3 rounded-full shadow-lg bg-emerald-600 text-white text-sm md:hidden">‡πÅ‡∏ä‡∏ï‡∏ú‡πà‡∏≤‡∏ô LINE</a>

  <!-- Backdrop + Drawer -->
  <div id="backdrop" class="backdrop"></div>
  <aside id="cartDrawer" class="drawer" aria-hidden="true">
    <div class="px-4 py-3 border-b flex items-center justify-between">
      <h3 class="font-semibold">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
      <button id="closeCart" class="text-gray-500 hover:text-gray-800">‚úï</button>
    </div>
    <div id="cartList" class="flex-1 overflow-auto divide-y"></div>
    <div class="border-t p-4 space-y-2">
      <div class="flex items-center justify-between text-sm">
        <span class="text-gray-600">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</span>
        <strong id="cartTotal" class="text-lg">‡∏ø0</strong>
      </div>
      <div class="flex gap-2">
        <button id="copyOrder" class="flex-1 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>
        <button id="checkout" class="flex-1 px-3 py-2 rounded-xl bg-emerald-600 text-white text-sm hover:opacity-90">LINE ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
      </div>
      <button id="clearCart" class="w-full px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
    </div>
  </aside>

  <script>
    // ======= CONFIG =======
    const STORE_NAME = '‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ';

    // LINE OA (‡∏°‡∏µ @ ‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤)
    const LINE_ID = '@906dooke';

    // ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏´‡∏•‡∏±‡∏Å: ‡∏û‡∏£‡∏µ‡∏ü‡∏¥‡∏•‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
    function lineChatUrl(text = '') {
      const id  = encodeURIComponent(LINE_ID);      // @ -> %40
      const msg = encodeURIComponent(text || '');   // encode ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤
      return `https://line.me/R/oaMessage/${id}/?text=${msg}`;
    }

    // Fallback: ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏≠‡∏õ/oaMessage ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö
    function lineAddFriendUrl() {
      const clean = LINE_ID.startsWith('@') ? LINE_ID : '@' + LINE_ID;
      return `https://line.me/R/ti/p/${clean}`;
    }

    // ‡∏ï‡∏±‡πâ‡∏á href ‡∏û‡∏£‡πâ‡∏≠‡∏° fallback ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    function setLineHref(el, text) {
      if (!el) return;
      // ‡πÉ‡∏ä‡πâ oaMessage ‡∏Å‡πà‡∏≠‡∏ô
      el.href = lineChatUrl(text);
      el.target = '_blank';
      el.rel = 'noopener';

      // ‡∏Å‡∏±‡∏ô‡πÄ‡∏Ñ‡∏™‡∏ö‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏≠‡∏õ LINE ‚Üí ‡πÉ‡∏´‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡∏ß‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏õ‡πÑ‡∏´‡∏ô ‡∏Å‡πá‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏≥‡∏£‡∏≠‡∏á
      el.addEventListener('error', () => { el.href = lineAddFriendUrl(); });
    }

    document.addEventListener('DOMContentLoaded', () => {
      const defaultMsg = '‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤';
      setLineHref(document.getElementById('lineLink'),       defaultMsg); // ‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏ô‡∏´‡∏±‡∏ß‡πÄ‡∏ß‡πá‡∏ö (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
      setLineHref(document.getElementById('fabChat'),        defaultMsg); // ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏≠‡∏¢‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
      setLineHref(document.getElementById('lineLinkFooter'), defaultMsg); // ‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô footer
    });

    // ‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ .txt (‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏Æ‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå): id,name,price,unit,category,img
    const RAW_TXT_URL = 'https://raw.githubusercontent.com/sutisukkawaguji-spec/maenoi-grocery/main/data/products.txt';

    // Top banners (‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå images/)
    const BANNERS = ['images/banner4.jpg','images/banner2.jpg','images/banner3.jpg'];

    // ======= STATE =======
    let PRODUCTS = [];
    let state = { q:'', category:'', min:'', max:'' };

    // ======= CART (‡πÄ‡∏Å‡πá‡∏ö id ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏ï‡∏£‡∏¥‡∏á‡πÄ‡∏™‡∏°‡∏≠) =======
    const toId = v => String(v ?? '').trim();
    let cart = (() => {
      const raw = JSON.parse(localStorage.getItem('cart') || '{}');
      return Object.fromEntries(Object.entries(raw).map(([k,v]) => [toId(k), Number(v)||0]));
    })();

    // ======= HELPERS =======
    const fmtBaht = n => new Intl.NumberFormat('th-TH', { style:'currency', currency:'THB', maximumFractionDigits:0 }).format(n);
    const findProduct = id => PRODUCTS.find(p => toId(p.id) === toId(id));
    const cartCount = () => Object.values(cart).reduce((a,b)=>a+(Number(b)||0),0);
    const cartTotal = () => Object.entries(cart).reduce((sum,[id,qty]) => {
      const p = findProduct(id); return sum + (p ? p.price*(Number(qty)||0) : 0);
    }, 0);
    function persistCart(){ localStorage.setItem('cart', JSON.stringify(cart)); }
    function updateBadge(){ document.getElementById('cartBadge').textContent = cartCount(); }
    function reconcileCart(){ let changed=false; for(const id of Object.keys(cart)){ if(!findProduct(id)){ delete cart[id]; changed=true; } } if(changed) persistCart(); updateBadge(); }

    // ======= PARSER: .txt ‚Üí items =======
    function toItem(cols, idx){
      const [idRaw,name,priceRaw,unit,category,img] = cols.map(v => (v ?? '').toString().trim());
      const id = idRaw || String(idx+1);
      const price = Number((priceRaw || '').replace(/[^\d.]/g,''));
      return { id: toId(id), name, price: Number.isFinite(price)?price:0, unit, category, img: img || 'images/cover.jpg', stock: 0 };
    }
    function parseLinesAuto(text){
      const clean = text.replace(/^\uFEFF/,'');
      const first = (clean.split(/\r?\n/).find(l => l.trim()) || '');
      const comma = (first.match(/,/g)||[]).length, tab = (first.match(/\t/g)||[]).length;
      const tryPapa = d => Papa.parse(clean,{ delimiter:d, skipEmptyLines:true, transform:v => (v??'').toString().trim() }).data
                       .filter(r => Array.isArray(r) && r.length >= 5);
      let rows = tryPapa(comma >= tab ? ',' : '\t');
      if(!rows.length) rows = tryPapa(comma >= tab ? '\t' : ',');
      return rows;
    }

    // ======= FILTER + RENDER =======
    function uniqueCategories(items){ return Array.from(new Set(items.map(i => i.category).filter(Boolean))).sort(); }
    function filterItems(items){
      const q = state.q.trim().toLowerCase();
      const c = state.category;
      const min = state.min === '' ? -Infinity : Number(state.min);
      const max = state.max === '' ? Infinity : Number(state.max);
      return items.filter(it => {
        const okQ = !q || (it.name||'').toLowerCase().includes(q);
        const okC = !c || it.category === c;
        const okP = it.price >= min && it.price <= max;
        return okQ && okC && okP;
      });
    }
    function renderCategories(){
      const sel = document.getElementById('categorySelect');
      sel.innerHTML = '<option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>';
      uniqueCategories(PRODUCTS).forEach(cat => {
        const opt = document.createElement('option'); opt.value = cat; opt.textContent = cat; sel.appendChild(opt);
      });
    }
    function renderGrid(items){
      const wrap = document.getElementById('productGrid');
      wrap.innerHTML = '';
      document.getElementById('resultCount').textContent = items.length;
      if(items.length === 0){
        wrap.innerHTML = '<div class="col-span-full text-center text-gray-500 py-10">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>';
        return;
      }
      const frag = document.createDocumentFragment();
      items.forEach(it => {
        const el = document.createElement('article');
        el.className = 'card bg-white border border-gray-200 rounded-2xl overflow-hidden shadow-sm transition-all';
        el.innerHTML = `
          <div class="aspect-[4/3] bg-gray-100 overflow-hidden">
            <img src="${it.img}" alt="${it.name}" class="w-full h-full object-cover" loading="lazy" width="800" height="600" />
          </div>
          <div class="p-3">
            <h3 class="text-sm font-semibold leading-tight">${it.name}</h3>
            <div class="mt-1 flex items-center justify-between">
              <span class="inline-flex items-center px-2 py-1 rounded-lg bg-emerald-50 text-emerald-700 text-xs font-medium">
                ${fmtBaht(it.price)} / ${it.unit || '-'}
              </span>
              <span class="text-xs text-gray-500">${it.category || '-'}</span>
            </div>
            <div class="mt-3 grid grid-cols-2 gap-2">
              <button class="btn-add w-full px-3 py-2 rounded-xl bg-emerald-600 text-white text-sm hover:opacity-90" data-id="${it.id}">‡∏´‡∏¢‡∏¥‡∏ö‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
              <button class="btn-chat w-full px-3 py-2 rounded-xl border text-sm hover:bg-gray-50" data-id="${it.id}">LINE ‡∏™‡∏±‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ</button>
            </div>
          </div>`;
        frag.appendChild(el);
      });
      wrap.appendChild(frag);
    }
    function renderCart(){
      const list = document.getElementById('cartList');
      list.innerHTML = '';
      const entries = Object.entries(cart);
      if(entries.length === 0){
        list.innerHTML = '<div class="p-4 text-center text-gray-500">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á</div>';
      } else {
        entries.forEach(([id, qty]) => {
          const p = findProduct(id);
          if(!p){ delete cart[id]; return; }
          const row = document.createElement('div');
          row.className = 'p-3 flex items-center gap-3';
          row.innerHTML = `
            <img src="${p.img}" alt="${p.name}" class="w-16 h-12 object-cover rounded-md border">
            <div class="flex-1">
              <div class="text-sm font-semibold">${p.name}</div>
              <div class="text-xs text-gray-500">${fmtBaht(p.price)} / ${p.unit || '-'}</div>
            </div>
            <div class="flex items-center gap-2">
              <button class="btn-dec px-2 py-1 rounded-lg border" data-id="${id}">-</button>
              <span class="w-8 text-center">${qty}</span>
              <button class="btn-inc px-2 py-1 rounded-lg border" data-id="${id}">+</button>
            </div>
            <div class="w-20 text-right font-medium">${fmtBaht(p.price * (Number(qty)||0))}</div>
          `;
          list.appendChild(row);
        });
      }
      document.getElementById('cartTotal').textContent = fmtBaht(cartTotal());
      persistCart();
    }

    // ======= ORDER TEXT & LINE =======
    function buildOrderText(){
      const lines = ['‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö: ' + STORE_NAME, ''];
      Object.entries(cart).forEach(([id, qty]) => {
        const p = findProduct(id); if(!p) return;
        lines.push(`- ${p.name} x ${qty} (${fmtBaht(p.price)} / ${p.unit || '-'}) = ${fmtBaht(p.price*(Number(qty)||0))}`);
      });
      lines.push('', '‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ' + fmtBaht(cartTotal()), '‡∏Ç‡∏≠‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á/‡∏ô‡∏±‡∏î‡∏£‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏∞');
      return lines.join('\n');
    }
    async function copyOrderToClipboard(){
      try{ await navigator.clipboard.writeText(buildOrderText()); alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏õ‡πÅ‡∏õ‡∏∞‡πÉ‡∏ô‡πÅ‡∏ä‡∏ï‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢'); }
      catch(e){
        const ta=document.createElement('textarea'); ta.value=buildOrderText(); document.body.appendChild(ta);
        ta.select(); document.execCommand('copy'); document.body.removeChild(ta);
        alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏õ‡πÅ‡∏õ‡∏∞‡πÉ‡∏ô‡πÅ‡∏ä‡∏ï‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢');
      }
    }
    function checkout(){ window.open(lineChatUrl(buildOrderText()), '_blank'); }

    // ======= SLIDER (auto-play + arrows + dots) =======
    function initSlider(){
      const container = document.querySelector('#slides > .flex');
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      const dotsWrap = document.getElementById('dots');
      const total = container.children.length;
      let idx = 0, timer = null, hover = false;

      // set widths (each img = 100%)
      Array.from(container.children).forEach(el => el.style.width = '100%');

      function go(n){
        idx = (n + total) % total;
        container.style.transform = `translateX(-${idx*100}%)`;
        renderDots();
      }
      function renderDots(){
        dotsWrap.innerHTML = '';
        for(let i=0;i<total;i++){
          const b = document.createElement('button');
          b.className = 'w-2.5 h-2.5 rounded-full ' + (i===idx?'bg-white':'bg-white/60 hover:bg-white');
          b.addEventListener('click', () => go(i));
          dotsWrap.appendChild(b);
        }
      }
      function play(){
        clearInterval(timer);
        timer = setInterval(()=>{ if(!hover) go(idx+1); }, 4000);
      }

      prevBtn.addEventListener('click', ()=>{ go(idx-1); play(); });
      nextBtn.addEventListener('click', ()=>{ go(idx+1); play(); });

      const sliderEl = document.getElementById('slider');
      sliderEl.addEventListener('mouseenter', ()=>{ hover = true; });
      sliderEl.addEventListener('mouseleave', ()=>{ hover = false; });

      renderDots(); play();
    }

    // ======= LOAD PRODUCTS =======
    async function loadProductsFromGitHubTxt(url = RAW_TXT_URL){
      try{
        const res = await fetch(url + '?_=' + Date.now(), { cache: 'no-store' });
        if(!res.ok) throw new Error('HTTP '+res.status);
        const text = await res.text();
        const rows = parseLinesAuto(text);
        PRODUCTS = rows.map(toItem);
        renderCategories();
        renderGrid(filterItems(PRODUCTS));
        reconcileCart();
      }catch(err){
        console.error('‡πÇ‡∏´‡∏•‡∏î GitHub .txt ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', err);
        alert('‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å GitHub ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡∏ï‡∏£‡∏ß‡∏à‡πÉ‡∏´‡πâ repo ‡πÄ‡∏õ‡πá‡∏ô public ‡πÅ‡∏•‡∏∞ path/branch ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
      }
    }

    // ======= INIT =======
    document.addEventListener('DOMContentLoaded', () => {
      // ‡∏õ‡∏µ‡πÉ‡∏ô‡∏ü‡∏∏‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå
      const y = document.getElementById('y'); if (y) y.textContent = new Date().getFullYear();

      // LINE links
      document.getElementById('lineLink').href = lineChatUrl('‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ ‡∏™‡∏ô‡πÉ‡∏à‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤');
      document.getElementById('lineLinkFooter').href = lineChatUrl('‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ ‡∏™‡∏ô‡πÉ‡∏à‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤');
      document.getElementById('fabChat').href = lineChatUrl('‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ ‡∏™‡∏ô‡πÉ‡∏à‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤');

      // Loading
      document.getElementById('productGrid').innerHTML =
        '<div class="col-span-full text-center text-gray-500 py-10">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤...</div>';

      // Filters
      document.getElementById('searchInput').addEventListener('input', e => { state.q = e.target.value; renderGrid(filterItems(PRODUCTS)); });
      document.getElementById('categorySelect').addEventListener('change', e => { state.category = e.target.value; renderGrid(filterItems(PRODUCTS)); });
      document.getElementById('minPrice').addEventListener('input', e => { state.min = e.target.value; renderGrid(filterItems(PRODUCTS)); });
      document.getElementById('maxPrice').addEventListener('input', e => { state.max = e.target.value; renderGrid(filterItems(PRODUCTS)); });
      document.getElementById('clearFilters').addEventListener('click', () => {
        state = { q:'', category:'', min:'', max:'' };
        document.getElementById('searchInput').value = '';
        document.getElementById('categorySelect').value = '';
        document.getElementById('minPrice').value = '';
        document.getElementById('maxPrice').value = '';
        renderGrid(filterItems(PRODUCTS));
      });

      // Product grid clicks
      document.getElementById('productGrid').addEventListener('click', (e) => {
        const addBtn = e.target.closest('.btn-add');
        const chatBtn = e.target.closest('.btn-chat');
        if (addBtn) {
          const id = toId(addBtn.dataset.id);
          const p  = findProduct(id); if(!p) return;
          cart[id] = (cart[id] || 0) + 1;
          persistCart(); updateBadge();
        }
        if (chatBtn) {
          const id = toId(chatBtn.dataset.id);
          const p  = findProduct(id); if(!p) return;
          const text = `‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: ${p.name} 1 ${p.unit || ''} ‡∏£‡∏≤‡∏Ñ‡∏≤ ${fmtBaht(p.price)}`;
          window.open(lineChatUrl(text), '_blank');
        }
      });

      // Cart controls
      document.getElementById('openCart').addEventListener('click', () => { document.getElementById('cartDrawer').classList.add('open'); document.getElementById('backdrop').classList.add('show'); renderCart(); });
      document.getElementById('closeCart').addEventListener('click', () => { document.getElementById('cartDrawer').classList.remove('open'); document.getElementById('backdrop').classList.remove('show'); });
      document.getElementById('backdrop').addEventListener('click', () => { document.getElementById('cartDrawer').classList.remove('open'); document.getElementById('backdrop').classList.remove('show'); });
      document.getElementById('clearCart').addEventListener('click', () => { cart = {}; persistCart(); renderCart(); updateBadge(); });
      document.getElementById('copyOrder').addEventListener('click', copyOrderToClipboard);
      document.getElementById('checkout').addEventListener('click', checkout);
      document.getElementById('cartList').addEventListener('click', (e) => {
        const inc = e.target.closest('.btn-inc'); const dec = e.target.closest('.btn-dec');
        if(inc || dec){
          const id = toId((inc||dec).dataset.id);
          if(!(id in cart)) cart[id] = 0;
          cart[id] = Math.max(0, (cart[id]||0) + (inc ? 1 : -1));
          if(cart[id] === 0) delete cart[id];
          renderCart(); updateBadge();
        }
      });

      // Slider
      initSlider();

      // SEO title
      document.title = STORE_NAME + ' ‚Äî ‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤';

      // Load products
      loadProductsFromGitHubTxt();
      updateBadge();
    });
  </script>
</body>
</html>
