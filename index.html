
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ ‚Äî ‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏≥</title>
  <meta name="description" content="‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏≥: ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡πÅ‡∏ä‡∏ï‡∏™‡∏±‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô Facebook Messenger" />

  <!-- Fonts + Tailwind -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Icons / PWA -->
  <link rel="icon" href="images/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" href="images/icon-192.png">
  <link rel="apple-touch-icon" href="images/icon-192.png">
  <meta name="theme-color" content="#10b981">
  <link rel="manifest" href="manifest.webmanifest">

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ ‚Äî ‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏≥‡πÉ‡∏Å‡∏•‡πâ‡∏ö‡πâ‡∏≤‡∏ô">
  <meta property="og:description" content="‡∏Å‡∏î‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏´‡∏¢‡∏¥‡∏ö‡πÉ‡∏™‡πà‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏ä‡∏ï‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ">
  <meta property="og:image" content="images/cover.jpg">
  <meta property="og:url" content="">
  <meta property="og:locale" content="th_TH">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ">
  <meta name="twitter:description" content="‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ + ‡πÅ‡∏ä‡∏ï‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ú‡πà‡∏≤‡∏ô Messenger">
  <meta name="twitter:image" content="images/cover.jpg">

  <style>
    body { font-family: 'Noto Sans Thai', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif; }
    .card:hover { transform: translateY(-2px); }
    button, a { touch-action: manipulation; }
    @media (max-width: 480px){
      .card h3 { font-size: 0.95rem; }
      #productGrid { gap: 0.6rem; }
    }
    .drawer {
      position: fixed; top: 0; right: -100%; width: 100%; max-width: 420px; height: 100%;
      background: #fff; box-shadow: -8px 0 24px rgba(0,0,0,.1); transition: right .28s ease;
      z-index: 60; display: flex; flex-direction: column;
    }
    .drawer.open { right: 0; }
    .backdrop {
      position: fixed; inset: 0; background: rgba(0,0,0,.35); backdrop-filter: blur(1px);
      z-index: 50; opacity: 0; pointer-events: none; transition: opacity .2s ease;
    }
    .backdrop.show { opacity: 1; pointer-events: all; }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Header -->
  <header class="sticky top-0 z-40 bg-white/80 backdrop-blur border-b border-gray-200">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center gap-3">
      <img src="images/logo.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ" class="w-10 h-10 rounded-xl object-cover">
      <div>
        <h1 class="text-lg font-semibold leading-tight">‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏≥</h1>
        <p class="text-xs text-gray-500">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡πÅ‡∏ä‡∏ï‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>
      </div>

      <div class="ms-auto flex items-center gap-2">
        <a id="messengerLink" href="#" target="_blank" class="hidden md:inline-flex items-center gap-2 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-4 h-4"><path fill="currentColor" d="M256 32C114.6 32 0 137.9 0 270.4C0 343.7 35.7 408.9 93.8 451.9C98.7 455.6 101.1 461.8 99.4 467.7L84.6 521.1C81.9 531.1 91.9 539.3 101.1 534.6L160.2 504.2C164.7 501.9 170 501.9 174.5 504.2C198.7 516.3 226.5 522.8 256 522.8C397.4 522.8 512 416.9 512 284.4C512 151.9 397.4 32 256 32zM282.4 318.9L231.4 270.4L114.3 348.6L238.4 212.3L289.4 260.8L406.6 182.6L282.4 318.9z"/></svg>
          ‡πÅ‡∏ä‡∏ï‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤
        </a>
        <!-- Cart Button -->
        <button id="openCart" class="relative inline-flex items-center gap-2 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
          üß∫ ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
          <span id="cartBadge" class="absolute -top-2 -right-2 min-w-[22px] h-[22px] px-1 rounded-full bg-emerald-600 text-white text-xs flex items-center justify-center">0</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Cover -->
  <section class="relative">
    <img src="images/cover.jpg" alt="‡∏†‡∏≤‡∏û‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ" class="w-full h-52 md:h-72 object-cover">
    <div class="absolute inset-0 bg-black/25 flex items-center justify-center">
      <h2 class="text-white text-2xl md:text-3xl font-bold drop-shadow">‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ</h2>
    </div>
  </section>

  <main class="max-w-6xl mx-auto px-4 py-6">
    <!-- Filters -->
    <section class="mb-5 grid grid-cols-1 md:grid-cols-12 gap-3">
      <div class="md:col-span-6">
        <label class="text-sm text-gray-600">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
        <input id="searchInput" type="search" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏≤‡∏°‡πà‡∏≤ ‡∏ô‡∏° UHT..." class="mt-1 w-full px-4 py-2.5 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-emerald-500" />
      </div>
      <div class="md:col-span-3">
        <label class="text-sm text-gray-600">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
        <select id="categorySelect" class="mt-1 w-full px-4 py-2.5 rounded-xl border border-gray-300 bg-white focus:outline-none focus:ring-2 focus:ring-emerald-500">
          <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
        </select>
      </div>
      <div class="md:col-span-3">
        <label class="text-sm text-gray-600">‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤</label>
        <div class="mt-1 flex items-center gap-2">
          <input id="minPrice" type="number" min="0" inputmode="numeric" placeholder="‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î" class="w-full px-4 py-2.5 rounded-xl border border-gray-300 focus:ring-2 focus:ring-emerald-500" />
          <span class="text-gray-400">-</span>
          <input id="maxPrice" type="number" min="0" inputmode="numeric" placeholder="‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î" class="w-full px-4 py-2.5 rounded-xl border border-gray-300 focus:ring-2 focus:ring-emerald-500" />
        </div>
      </div>
    </section>

    <!-- Stats -->
    <section class="mb-4 text-sm text-gray-600 flex items-center gap-3">
      <span id="resultCount">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
      <span class="hidden md:inline">‚Ä¢</span>
      <button id="clearFilters" class="text-emerald-700 hover:underline">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</button>
    </section>

    <!-- Product Grid -->
    <section id="productGrid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4"></section>
  </main>

  <!-- Footer -->
  <footer class="border-t border-gray-200 py-10 text-center text-sm bg-white">
    <h3 class="text-lg font-semibold mb-2 text-emerald-700">‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ</h3>
    <p class="text-gray-600">üè† ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ ‡∏ï‡∏≥‡∏ö‡∏•‡∏•‡∏≥‡∏†‡∏π ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π 39000</p>
    <p class="text-gray-600 mt-1">üìû ‡πÇ‡∏ó‡∏£: <a href="tel:0880699227" class="text-emerald-700 hover:underline">088-069-9227</a></p>
    <div class="flex items-center justify-center gap-3 mt-3">
      <a href="https://facebook.com/‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ" target="_blank"
        class="inline-flex items-center gap-1 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
        <img src="https://cdn-icons-png.flaticon.com/512/124/124010.png" class="w-4 h-4" alt=""> Facebook
      </a>
      <a href="https://line.me/ti/p/~YOUR_LINE_ID" target="_blank"
        class="inline-flex items-center gap-1 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
        <img src="https://cdn-icons-png.flaticon.com/512/2111/2111390.png" class="w-4 h-4" alt=""> Line
      </a>
      <button onclick="document.getElementById('qrModal').showModal()"
        class="inline-flex items-center gap-1 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
        <img src="https://cdn-icons-png.flaticon.com/512/1042/1042339.png" class="w-4 h-4" alt=""> PromptPay
      </button>
    </div>
    <p class="mt-6 text-gray-400 text-xs">¬© <span id="y"></span> ‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ ‚Äî ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</p>
  </footer>

  <!-- Modal QR PromptPay -->
  <dialog id="qrModal" class="p-0 rounded-2xl shadow-2xl">
    <div class="p-4 bg-white rounded-2xl">
      <h3 class="text-center text-lg font-semibold mb-2">PromptPay</h3>
      <img src="images/promptpay.png" alt="QR PromptPay" class="w-40 h-40 mx-auto border rounded-lg">
      <p class="text-center text-gray-600 mt-2">‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
      <div class="text-center mt-3">
        <button onclick="document.getElementById('qrModal').close()" class="text-emerald-700 hover:underline text-sm">‡∏õ‡∏¥‡∏î</button>
      </div>
    </div>
  </dialog>

  <!-- Floating Chat Button (mobile) -->
  <a id="fabChat" class="fixed bottom-4 right-4 z-50 px-4 py-3 rounded-full shadow-lg bg-emerald-600 text-white text-sm md:hidden">‡πÅ‡∏ä‡∏ï‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</a>

  <!-- Backdrop + Drawer -->
  <div id="backdrop" class="backdrop"></div>
  <aside id="cartDrawer" class="drawer" aria-hidden="true">
    <div class="px-4 py-3 border-b flex items-center justify-between">
      <h3 class="font-semibold">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
      <button id="closeCart" class="text-gray-500 hover:text-gray-800">‚úï</button>
    </div>
    <div id="cartList" class="flex-1 overflow-auto divide-y"></div>
    <div class="border-t p-4 space-y-2">
      <div class="flex items-center justify-between text-sm">
        <span class="text-gray-600">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</span>
        <strong id="cartTotal" class="text-lg">‡∏ø0</strong>
      </div>
      <div class="flex gap-2">
        <button id="copyOrder" class="flex-1 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>
        <button id="checkout" class="flex-1 px-3 py-2 rounded-xl bg-emerald-600 text-white text-sm hover:opacity-90">‡πÅ‡∏ä‡∏ï‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
      </div>
      <button id="clearCart" class="w-full px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
    </div>
  </aside>

  <!-- Facebook SDK & Chat Plugin -->
  <div id="fb-root"></div>
  <div id="fb-customer-chat" class="fb-customerchat"></div>

  <script>
    // ======= CONFIG (‡πÉ‡∏™‡πà‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠‡∏á) =======
    const FB_PAGE_ID = '801626436372815';   // Page ID ‡πÄ‡∏û‡∏à‡∏Ñ‡∏∏‡∏ì
    const FB_APP_ID  = '1132550158989466';  // App ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    const STORE_NAME = '‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ';

    // ======= PRODUCTS (‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ) =======
    const PRODUCTS = [
      { id: 1,  name: '‡∏°‡∏≤‡∏°‡πà‡∏≤ ‡∏ö‡∏∞‡∏´‡∏°‡∏µ‡πà‡∏Å‡∏∂‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏£‡∏π‡∏õ (‡∏ï‡πâ‡∏°‡∏¢‡∏≥‡∏Å‡∏∏‡πâ‡∏á)', price: 7,   unit:'‡∏ã‡∏≠‡∏á',  category:'‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏´‡πâ‡∏á', img:'img: 'https://raw.githubusercontent.com/sutisukkawaguji-spec/maenoi-grocery/main/images/order01.png'},
      { id: 2,  name: '‡∏õ‡∏•‡∏≤‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á ‡∏ï‡∏£‡∏≤‡∏°‡πâ‡∏≤',                 price: 30,  unit:'‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á', category:'‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏´‡πâ‡∏á', img:'https://images.unsplash.com/photo-1615486363871-838320b7be1a?q=80&w=800&auto=format&fit=crop' },
      { id: 3,  name: '‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡∏´‡∏≠‡∏°‡∏°‡∏∞‡∏•‡∏¥ 5 ‡∏Å‡∏Å.',               price: 165, unit:'‡∏ñ‡∏∏‡∏á',  category:'‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£',   img:'https://images.unsplash.com/photo-1566837935700-30057527ade0?q=80&w=800&auto=format&fit=crop' },
      { id: 4,  name: '‡∏ô‡∏° UHT ‡∏£‡∏™‡∏à‡∏∑‡∏î 200ml',                  price: 12,  unit:'‡∏Å‡∏•‡πà‡∏≠‡∏á', category:'‡∏ô‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°', img:'https://images.unsplash.com/photo-1580915411954-282cb1b0d780?q=80&w=800&auto=format&fit=crop' },
      { id: 5,  name: '‡πÇ‡∏Ñ‡πâ‡∏Å 1.25 ‡∏•‡∏¥‡∏ï‡∏£',                       price: 28,  unit:'‡∏Ç‡∏ß‡∏î',  category:'‡∏ô‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°', img:'https://images.unsplash.com/photo-1541976076758-347942db1979?q=80&w=800&auto=format&fit=crop' },
      { id: 6,  name: '‡πÑ‡∏Ç‡πà‡πÑ‡∏Å‡πà ‡πÄ‡∏ö‡∏≠‡∏£‡πå 2 (‡πÅ‡∏ú‡∏á 30 ‡∏ü‡∏≠‡∏á)',         price: 120, unit:'‡πÅ‡∏ú‡∏á',  category:'‡∏Ç‡∏≠‡∏á‡∏™‡∏î/‡∏Ç‡∏≠‡∏á‡πÅ‡∏ä‡πà‡πÄ‡∏¢‡πá‡∏ô', img:'https://images.unsplash.com/photo-1517959105821-eaf2591984de?q=80&w=800&auto=format&fit=crop' },
      { id: 7,  name: '‡∏™‡∏ö‡∏π‡πà‡∏Å‡πâ‡∏≠‡∏ô ‡∏™‡∏π‡∏ï‡∏£‡∏≠‡πà‡∏≠‡∏ô‡πÇ‡∏¢‡∏ô',                 price: 22,  unit:'‡∏Å‡πâ‡∏≠‡∏ô', category:'‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô', img:'https://images.unsplash.com/photo-1523293182086-7651a899d37f?q=80&w=800&auto=format&fit=crop' },
      { id: 8,  name: '‡∏ô‡πâ‡∏≥‡∏õ‡∏•‡∏≤ 700ml',                         price: 28,  unit:'‡∏Ç‡∏ß‡∏î',  category:'‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∏‡∏á', img:'https://images.unsplash.com/photo-1586201375761-83865001e31b?q=80&w=800&auto=format&fit=crop' },
      { id: 9,  name: '‡∏ã‡∏µ‡∏≠‡∏¥‡πä‡∏ß‡∏Ç‡∏≤‡∏ß 700ml',                      price: 29,  unit:'‡∏Ç‡∏ß‡∏î',  category:'‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∏‡∏á', img:'https://images.unsplash.com/photo-1604908552967-78f3dc5f74f3?q=80&w=800&auto=format&fit=crop' },
      { id: 10, name: '‡∏õ‡∏•‡∏≤‡∏Å‡∏£‡∏≠‡∏ö‡∏ã‡∏≠‡∏á',                           price: 15,  unit:'‡∏ã‡∏≠‡∏á',  category:'‡∏Ç‡∏ô‡∏°‡∏Ç‡∏ö‡πÄ‡∏Ñ‡∏µ‡πâ‡∏¢‡∏ß', img:'https://images.unsplash.com/photo-1580231962143-c2d6492436e4?q=80&w=800&auto=format&fit=crop' },
      { id: 11, name: '‡πÄ‡∏•‡∏¢‡πå 48 ‡∏Å‡∏£‡∏±‡∏°',                          price: 20,  unit:'‡∏ã‡∏≠‡∏á',  category:'‡∏Ç‡∏ô‡∏°‡∏Ç‡∏ö‡πÄ‡∏Ñ‡∏µ‡πâ‡∏¢‡∏ß', img:'https://images.unsplash.com/photo-1617217131157-1c162255ea8f?q=80&w=800&auto=format&fit=crop' },
      { id: 12, name: '‡∏Å‡∏≤‡πÅ‡∏ü‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á 180ml',                    price: 15,  unit:'‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á', category:'‡∏ô‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°', img:'https://images.unsplash.com/photo-1498804103079-a6351b050096?q=80&w=800&auto=format&fit=crop' },
      { id: 13, name: '‡∏ô‡πâ‡∏≥‡∏î‡∏∑‡πà‡∏° 600ml',                         price: 7,   unit:'‡∏Ç‡∏ß‡∏î',  category:'‡∏ô‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°', img:'https://images.unsplash.com/photo-1548839140-29a749e1cf4d?q=80&w=800&auto=format&fit=crop' },
      { id: 14, name: '‡∏¢‡∏≤‡∏™‡∏£‡∏∞‡∏ú‡∏° 450ml',                        price: 89,  unit:'‡∏Ç‡∏ß‡∏î',  category:'‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô', img:'https://images.unsplash.com/photo-1631730484817-816ba0bdab58?q=80&w=800&auto=format&fit=crop' },
      { id: 15, name: '‡∏¢‡∏≤‡∏™‡∏µ‡∏ü‡∏±‡∏ô 160 ‡∏Å‡∏£‡∏±‡∏°',                     price: 49,  unit:'‡∏´‡∏•‡∏≠‡∏î', category:'‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô', img:'https://images.unsplash.com/photo-1598440947619-2c35fc9a6e2b?q=80&w=800&auto=format&fit=crop' },
      { id: 16, name: '‡∏¢‡∏≤‡∏™‡∏µ‡∏ü‡∏±‡∏ô 160 ‡∏Å‡∏£‡∏±‡∏°',                     price: 100,  unit:'‡∏´‡∏•‡∏≠‡∏î', category:'‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô', img:'https://github.com/sutisukkawaguji-spec/maenoi-grocery/blob/main/images/Screenshot%202025-10-20%20162832.png' }

    ];

    // ======= STATE + STORAGE =======
    let state = { q: '', category: '', min: '', max: '' };
    let cart = JSON.parse(localStorage.getItem('cart') || '{}'); // {productId: qty}

    // ======= HELPERS =======
    const fmtBaht = n => new Intl.NumberFormat('th-TH', { style: 'currency', currency: 'THB', maximumFractionDigits: 0 }).format(n);
    const findProduct = id => PRODUCTS.find(p => p.id === Number(id));
    const cartCount = () => Object.values(cart).reduce((a,b)=>a+b,0);
    const cartTotal = () => Object.entries(cart).reduce((sum,[id,qty]) => sum + findProduct(id).price * qty, 0);

    function uniqueCategories(items){ return Array.from(new Set(items.map(i => i.category))).sort(); }

    function filterItems(items){
      const q = state.q.trim().toLowerCase();
      const c = state.category;
      const min = state.min === '' ? -Infinity : Number(state.min);
      const max = state.max === '' ? Infinity : Number(state.max);
      return items.filter(it => {
        const okQ = !q || it.name.toLowerCase().includes(q);
        const okC = !c || it.category === c;
        const okP = it.price >= min && it.price <= max;
        return okQ && okC && okP;
      });
    }

    function renderCategories(){
      const sel = document.getElementById('categorySelect');
      sel.innerHTML = '<option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>'; // reset to avoid duplicates
      uniqueCategories(PRODUCTS).forEach(cat => {
        const opt = document.createElement('option');
        opt.value = cat; opt.textContent = cat; sel.appendChild(opt);
      });
    }

    function persistCart(){ localStorage.setItem('cart', JSON.stringify(cart)); }
    function updateBadge(){ document.getElementById('cartBadge').textContent = cartCount(); }

    // Render cards (no inline JS to avoid syntax issues)
    function renderGrid(items){
      const wrap = document.getElementById('productGrid');
      wrap.innerHTML = '';
      document.getElementById('resultCount').textContent = items.length;
      if(items.length === 0){
        wrap.innerHTML = '<div class="col-span-full text-center text-gray-500 py-10">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤</div>';
        return;
      }
      const frag = document.createDocumentFragment();
      items.forEach(it => {
        const el = document.createElement('article');
        el.className = 'card bg-white border border-gray-200 rounded-2xl overflow-hidden shadow-sm transition-all';
        el.innerHTML = `
          <div class="aspect-[4/3] bg-gray-100 overflow-hidden">
            <img src="${it.img}" alt="${it.name}" class="w-full h-full object-cover" loading="lazy" width="800" height="600" />
          </div>
          <div class="p-3">
            <h3 class="text-sm font-semibold leading-tight">${it.name}</h3>
            <div class="mt-1 flex items-center justify-between">
              <span class="inline-flex items-center px-2 py-1 rounded-lg bg-emerald-50 text-emerald-700 text-xs font-medium">${fmtBaht(it.price)} / ${it.unit}</span>
              <span class="text-xs text-gray-500">${it.category}</span>
            </div>
            <div class="mt-3 grid grid-cols-2 gap-2">
              <button class="btn-add w-full px-3 py-2 rounded-xl bg-emerald-600 text-white text-sm hover:opacity-90" data-id="${it.id}">‡∏´‡∏¢‡∏¥‡∏ö‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
              <button class="btn-chat w-full px-3 py-2 rounded-xl border text-sm hover:bg-gray-50" data-id="${it.id}">‡πÅ‡∏ä‡∏ï‡∏™‡∏±‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ</button>
            </div>
          </div>`;
        frag.appendChild(el);
      });
      wrap.appendChild(frag);
    }

    function renderCart(){
      const list = document.getElementById('cartList');
      list.innerHTML = '';
      const entries = Object.entries(cart);
      if(entries.length === 0){
        list.innerHTML = '<div class="p-4 text-center text-gray-500">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á</div>';
      } else {
        entries.forEach(([id, qty]) => {
          const p = findProduct(id);
          const row = document.createElement('div');
          row.className = 'p-3 flex items-center gap-3';
          row.innerHTML = `
            <img src="${p.img}" alt="${p.name}" class="w-16 h-12 object-cover rounded-md border">
            <div class="flex-1">
              <div class="text-sm font-semibold">${p.name}</div>
              <div class="text-xs text-gray-500">${fmtBaht(p.price)} / ${p.unit}</div>
            </div>
            <div class="flex items-center gap-2">
              <button class="btn-dec px-2 py-1 rounded-lg border" data-id="${id}">-</button>
              <span class="w-8 text-center">${qty}</span>
              <button class="btn-inc px-2 py-1 rounded-lg border" data-id="${id}">+</button>
            </div>
            <div class="w-20 text-right font-medium">${fmtBaht(p.price * qty)}</div>
          `;
          list.appendChild(row);
        });
      }
      document.getElementById('cartTotal').textContent = fmtBaht(cartTotal());
    }

    function buildOrderText(){
      const lines = ['‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö: ' + STORE_NAME, ''];
      Object.entries(cart).forEach(([id, qty]) => {
        const p = findProduct(id);
        lines.push(`- ${p.name} x ${qty} (${fmtBaht(p.price)} / ${p.unit}) = ${fmtBaht(p.price*qty)}`);
      });
      lines.push('');
      lines.push('‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ' + fmtBaht(cartTotal()));
      lines.push('‡∏Ç‡∏≠‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á/‡∏ô‡∏±‡∏î‡∏£‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö');
      return lines.join('\n');
    }

    async function copyOrderToClipboard(){
      try{
        await navigator.clipboard.writeText(buildOrderText());
        alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏õ‡πÅ‡∏õ‡∏∞‡πÉ‡∏ô‡πÅ‡∏ä‡∏ï‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢');
      }catch(e){
        const textarea = document.createElement('textarea');
        textarea.value = buildOrderText();
        document.body.appendChild(textarea);
        textarea.select(); document.execCommand('copy'); document.body.removeChild(textarea);
        alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏õ‡πÅ‡∏õ‡∏∞‡πÉ‡∏ô‡πÅ‡∏ä‡∏ï‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢');
      }
    }

    function checkout(){
      const ref = 'order_' + Date.now();
      window.open('https://m.me/' + FB_PAGE_ID + '?ref=' + ref, '_blank');
    }

    function openCart(){ document.getElementById('cartDrawer').classList.add('open'); document.getElementById('backdrop').classList.add('show'); renderCart(); }
    function closeCart(){ document.getElementById('cartDrawer').classList.remove('open'); document.getElementById('backdrop').classList.remove('show'); }

    function syncUI(){ renderCategories(); renderGrid(filterItems(PRODUCTS)); }

    // ======= INIT =======
    document.addEventListener('DOMContentLoaded', () => {
      // Year
      const y = document.getElementById('y'); if (y) y.textContent = new Date().getFullYear();

      syncUI();
      updateBadge();

      // Filter events
      document.getElementById('searchInput').addEventListener('input', e => { state.q = e.target.value; renderGrid(filterItems(PRODUCTS)); });
      document.getElementById('categorySelect').addEventListener('change', e => { state.category = e.target.value; renderGrid(filterItems(PRODUCTS)); });
      document.getElementById('minPrice').addEventListener('input', e => { state.min = e.target.value; renderGrid(filterItems(PRODUCTS)); });
      document.getElementById('maxPrice').addEventListener('input', e => { state.max = e.target.value; renderGrid(filterItems(PRODUCTS)); });
      document.getElementById('clearFilters').addEventListener('click', () => {
        state = { q:'', category:'', min:'', max:'' };
        document.getElementById('searchInput').value = '';
        document.getElementById('categorySelect').value = '';
        document.getElementById('minPrice').value = '';
        document.getElementById('maxPrice').value = '';
        renderGrid(filterItems(PRODUCTS));
      });

      // Buttons (delegation)
      document.getElementById('productGrid').addEventListener('click', (e) => {
        const addBtn = e.target.closest('.btn-add');
        const chatBtn = e.target.closest('.btn-chat');
        if (addBtn) {
          const id = addBtn.getAttribute('data-id');
          cart[id] = (cart[id] || 0) + 1;
          persistCart(); updateBadge();
        }
        if (chatBtn) {
          const id = chatBtn.getAttribute('data-id');
          const ref = 'buy_' + id;
          window.open('https://m.me/' + FB_PAGE_ID + '?ref=' + ref, '_blank');
        }
      });

      document.getElementById('openCart').addEventListener('click', openCart);
      document.getElementById('closeCart').addEventListener('click', closeCart);
      document.getElementById('backdrop').addEventListener('click', closeCart);
      document.getElementById('clearCart').addEventListener('click', () => { cart = {}; persistCart(); renderCart(); updateBadge(); });
      document.getElementById('copyOrder').addEventListener('click', copyOrderToClipboard);
      document.getElementById('checkout').addEventListener('click', checkout);

      // Messenger links
      document.getElementById('messengerLink').href = 'https://m.me/' + FB_PAGE_ID;
      document.getElementById('fabChat').href = 'https://m.me/' + FB_PAGE_ID;

      // Facebook Chat Plugin (ignore on file://; works on domain)
      if(FB_PAGE_ID && FB_PAGE_ID !== 'YOUR_PAGE_ID'){
        const chatbox = document.getElementById('fb-customer-chat');
        chatbox.setAttribute('page_id', FB_PAGE_ID);
        chatbox.setAttribute('attribution', 'biz_inbox');
        window.fbAsyncInit = function() { FB.init({ xfbml: true, version: 'v20.0', appId: FB_APP_ID }); };
        (function(d, s, id){
          var js, fjs = d.getElementsByTagName(s)[0];
          if (d.getElementById(id)) return;
          js = d.createElement(s); js.id = id;
          js.src = 'https://connect.facebook.net/th_TH/sdk/xfbml.customerchat.js';
          fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
      }

      // SEO title
      document.title = STORE_NAME + ' ‚Äî ‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤';
    });
  </script>
</body>
</html>
