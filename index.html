<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ ‚Äî ‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏≥</title>
  <meta name="description" content="‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏≥: ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ ‡πÄ‡∏°‡∏ô‡∏π‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‡πÅ‡∏•‡∏∞‡πÅ‡∏ä‡∏ï‡∏ú‡πà‡∏≤‡∏ô LINE" />

  <!-- Fonts + Tailwind -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Icons / PWA -->
  <link rel="icon" href="images/favicon.ico" sizes="any">
  <link rel="apple-touch-icon" href="images/icon-192.png">
  <meta name="theme-color" content="#10b981">
  <link rel="manifest" href="manifest.webmanifest">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ ‚Äî ‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏≥‡πÉ‡∏Å‡∏•‡πâ‡∏ö‡πâ‡∏≤‡∏ô">
  <meta property="og:description" content="‡∏î‡∏π‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏´‡∏¢‡∏¥‡∏ö‡πÉ‡∏™‡πà‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ ‡πÄ‡∏°‡∏ô‡∏π‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‡πÅ‡∏•‡∏∞‡πÅ‡∏ä‡∏ï‡∏™‡∏±‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô LINE">
  <meta property="og:image" content="images/cover.jpg">
  <meta property="og:locale" content="th_TH">

  <style>
    body { font-family: 'Noto Sans Thai', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif; }
    .card:hover { transform: translateY(-2px); }
    button, a { touch-action: manipulation; }
    @media (max-width: 480px){
      .card h3 { font-size: 0.95rem; }
      #productGrid { gap: 0.6rem; }
    }
    .drawer { position: fixed; top: 0; right: -100%; width: 100%; max-width: 420px; height: 100%;
      background: #fff; box-shadow: -8px 0 24px rgba(0,0,0,.1); transition: right .28s ease;
      z-index: 60; display: flex; flex-direction: column; }
    .drawer.open { right: 0; }
    .backdrop { position: fixed; inset: 0; background: rgba(0,0,0,.35); backdrop-filter: blur(1px);
      z-index: 50; opacity: 0; pointer-events: none; transition: opacity .2s ease; }
    .backdrop.show { opacity: 1; pointer-events: all; }
  </style>

  <!-- PapaParse (‡∏≠‡πà‡∏≤‡∏ô .txt/.csv) -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body class="bg-gray-50 text-gray-900">
  <!-- Header -->
  <header class="sticky top-0 z-40 bg-white/80 backdrop-blur border-b border-gray-200">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center gap-3">
      <img src="images/logo.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏£‡πâ‡∏≤‡∏ô" class="w-10 h-10 rounded-xl object-cover">
      <div>
        <h1 class="text-lg font-semibold leading-tight">‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ä‡∏≥</h1>
        <p class="text-xs text-gray-500">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‚Ä¢ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà ‚Ä¢ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ ‚Ä¢ ‡πÄ‡∏°‡∏ô‡∏π‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ ‚Ä¢ ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ ‚Ä¢ LINE</p>
      </div>

      <div class="ms-auto flex items-center gap-2">
        <a id="lineLink" href="#" target="_blank"
           class="hidden md:inline-flex items-center gap-2 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
          üí¨ ‡πÅ‡∏ä‡∏ï LINE
        </a>
        <button id="openCart" class="relative inline-flex items-center gap-2 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
          üß∫ ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
          <span id="cartBadge" class="absolute -top-2 -right-2 min-w-[22px] h-[22px] px-1 rounded-full bg-emerald-600 text-white text-xs flex items-center justify-center">0</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Cover -->
  <section class="relative">
    <img src="images/cover.jpg" alt="‡∏†‡∏≤‡∏û‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô" class="w-full h-64 md:h-96 object-cover">
    <div class="absolute inset-0 bg-black/25 flex items-center justify-center">
      <h2 class="text-white text-2xl md:text-3xl font-bold drop-shadow">‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ</h2>
    </div>
  </section>

  <!-- ‡πÄ‡∏°‡∏ô‡∏π‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡∏™‡πÑ‡∏•‡∏î‡πå‡∏£‡∏π‡∏õ+‡∏ä‡∏∑‡πà‡∏≠) -->
  <section class="relative bg-white mt-4">
    <div class="max-w-6xl mx-auto px-4">
      <h3 class="font-semibold mb-2">üçΩÔ∏è ‡πÄ‡∏°‡∏ô‡∏π‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h3>
      <div id="menuToday" class="overflow-hidden rounded-xl border">
        <div id="menuTrack" class="flex transition-transform duration-500 ease-out"></div>
      </div>
    </div>
  </section>

  <main class="max-w-6xl mx-auto px-4 py-6">
    <!-- Filters -->
    <section class="mb-5 grid grid-cols-1 md:grid-cols-12 gap-3">
      <div class="md:col-span-5">
        <label class="text-sm text-gray-600">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
        <input id="searchInput" type="search" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏≤‡∏°‡πà‡∏≤ ‡∏ô‡∏° UHT..." class="mt-1 w-full px-4 py-2.5 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-emerald-500" />
      </div>
      <div class="md:col-span-3">
        <label class="text-sm text-gray-600">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
        <select id="categorySelect" class="mt-1 w-full px-4 py-2.5 rounded-xl border border-gray-300 bg-white focus:outline-none focus:ring-2 focus:ring-emerald-500">
          <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
        </select>
      </div>
      <div class="md:col-span-3">
        <label class="text-sm text-gray-600">‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤</label>
        <div class="mt-1 flex items-center gap-2">
          <input id="minPrice" type="number" min="0" inputmode="numeric" placeholder="‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î" class="w-full px-4 py-2.5 rounded-xl border border-gray-300 focus:ring-2 focus:ring-emerald-500" />
          <span class="text-gray-400">-</span>
          <input id="maxPrice" type="number" min="0" inputmode="numeric" placeholder="‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î" class="w-full px-4 py-2.5 rounded-xl border border-gray-300 focus:ring-2 focus:ring-emerald-500" />
        </div>
      </div>
      <div class="md:col-span-1 flex items-end">
        <label class="inline-flex items-center gap-2 text-sm"><input id="onlyFeatured" type="checkbox"> ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</label>
      </div>
    </section>

    <!-- Stats -->
    <section class="mb-4 text-sm text-gray-600 flex items-center gap-3">
      <span id="resultCount">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
      <span class="hidden md:inline">‚Ä¢</span>
      <button id="clearFilters" class="text-emerald-700 hover:underline">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</button>
    </section>

    <!-- Product Grid -->
    <section id="productGrid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4"></section>
  </main>

  <!-- Footer -->
  <footer class="border-t border-gray-200 py-10 text-center text-sm bg-white">
    <h3 class="text-lg font-semibold mb-2 text-emerald-700">‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ</h3>
    <p class="text-gray-600">üè† ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ ‡∏ï‡∏≥‡∏ö‡∏•‡∏•‡∏≥‡∏†‡∏π ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π 39000</p>
    <p class="text-gray-600 mt-1">üìû ‡πÇ‡∏ó‡∏£: <a href="tel:0880699227" class="text-emerald-700 hover:underline">088-069-9227</a></p>
    <div class="flex items-center justify-center gap-3 mt-3">
      <a href="https://facebook.com/801626436372815" target="_blank" rel="noopener"
         class="inline-flex items-center gap-1 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
        <img src="https://cdn-icons-png.flaticon.com/512/124/124010.png" class="w-4 h-4" alt=""> Facebook
      </a>
      <a id="lineLinkFooter" href="#" target="_blank" rel="noopener"
         class="inline-flex items-center gap-1 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
        <img src="https://cdn-icons-png.flaticon.com/512/2111/2111390.png" class="w-4 h-4" alt=""> LINE
      </a>
      <button type="button" onclick="document.getElementById('qrModal').showModal()"
              class="inline-flex items-center gap-1 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">
        <img src="https://cdn-icons-png.flaticon.com/512/1042/1042339.png" class="w-4 h-4" alt=""> PromptPay
      </button>
    </div>
    <p class="mt-6 text-gray-400 text-xs">¬© <span id="y"></span> ‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ ‚Äî ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</p>
  </footer>

  <!-- Modal QR PromptPay -->
  <dialog id="qrModal" class="p-0 rounded-2xl shadow-2xl">
    <div class="p-4 bg-white rounded-2xl">
      <h3 class="text-center text-lg font-semibold mb-2">PromptPay</h3>
      <img src="images/promptpay.png" alt="QR PromptPay" class="w-40 h-40 mx-auto border rounded-lg object-contain">
      <p class="text-center text-gray-600 mt-2">‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
      <div class="text-center mt-3">
        <button type="button" onclick="document.getElementById('qrModal').close()" class="text-emerald-700 hover:underline text-sm">‡∏õ‡∏¥‡∏î</button>
      </div>
    </div>
  </dialog>

  <!-- Admin Auth Dialog (‡πÉ‡∏™‡πà PIN ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤) -->
  <dialog id="adminAuth" class="rounded-2xl p-0 overflow-hidden">
    <div class="p-4 bg-white w-[92vw] max-w-md">
      <h3 class="text-lg font-semibold">üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</h3>
      <p class="text-sm text-gray-600 mt-1">‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™ PIN</p>
      <input id="adminPinInput" type="password" inputmode="numeric" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2468"
             class="mt-3 w-full px-3 py-2 rounded-xl border" />
      <div class="mt-4 flex items-center justify-end gap-2">
        <button class="px-3 py-2 rounded-xl border" onclick="document.getElementById('adminAuth').close()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        <button id="adminLoginBtn" class="px-3 py-2 rounded-xl bg-emerald-600 text-white">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>
  </dialog>

  <!-- === ADMIN PANEL (‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ) === -->
  <section id="adminPanel" class="max-w-6xl mx-auto px-4 py-6 hidden">
    <div class="mb-4 flex items-center justify-between">
      <h2 class="text-lg font-semibold">‡πÇ‡∏´‡∏°‡∏î‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</h2>
      <div class="flex gap-2">
        <button id="btnExport" class="px-3 py-1.5 rounded border">Export JSON</button>
        <label class="px-3 py-1.5 rounded border cursor-pointer">Import JSON
          <input id="importFile" type="file" accept="application/json" class="hidden">
        </label>
        <button id="btnCloseAdmin" class="px-3 py-1.5 rounded border">‡∏õ‡∏¥‡∏î</button>
      </div>
    </div>

    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
    <div class="grid md:grid-cols-2 gap-6">
      <div class="border rounded-2xl p-4 bg-white">
        <h3 class="font-semibold mb-2">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á)</h3>
        <div class="grid grid-cols-2 gap-3 text-sm">
          <input id="p_id" placeholder="id (‡πÄ‡∏ß‡πâ‡∏ô‡πÑ‡∏î‡πâ: ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏£‡∏±‡∏ô)" class="px-3 py-2 border rounded">
          <input id="p_name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ *" class="px-3 py-2 border rounded col-span-1 md:col-span-1">
          <input id="p_price" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤ *" type="number" class="px-3 py-2 border rounded">
          <input id="p_unit" placeholder="‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô ‡∏ã‡∏≠‡∏á/‡∏Ç‡∏ß‡∏î" class="px-3 py-2 border rounded">
          <input id="p_cat" placeholder="‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà ‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏´‡πâ‡∏á" class="px-3 py-2 border rounded col-span-2">
          <input id="p_img" placeholder="‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ WebP/JPG)" class="px-3 py-2 border rounded col-span-2">
          <label class="flex items-center gap-2 col-span-1"><input id="p_active" type="checkbox" checked> ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
          <label class="flex items-center gap-2 col-span-1"><input id="p_featured" type="checkbox"> ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</label>
          <button id="btnAddProduct" class="col-span-2 px-4 py-2 bg-emerald-600 text-white rounded">‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
        </div>
      </div>

      <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ + ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
      <div class="border rounded-2xl p-4 bg-white">
        <h3 class="font-semibold mb-2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏Ñ‡∏•‡∏¥‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏•‡∏±‡∏ö)</h3>
        <div id="adminList" class="text-sm space-y-2 max-h-[360px] overflow-auto"></div>
        <p class="text-xs text-gray-500 mt-2">* ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å GitHub ‡πÅ‡∏™‡∏î‡∏á‡∏î‡πâ‡∏ß‡∏¢ üîí ‚Äî ‡∏õ‡∏£‡∏±‡∏ö ‚Äú‡πÅ‡∏™‡∏î‡∏á/‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‚Äù ‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡πÅ‡∏Å‡πâ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ</p>
      </div>
    </div>

    <!-- ‡πÄ‡∏°‡∏ô‡∏π‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ -->
    <div class="border rounded-2xl p-4 bg-white mt-6">
      <h3 class="font-semibold mb-3">‡πÄ‡∏°‡∏ô‡∏π‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (‡∏£‡∏π‡∏õ‡∏ß‡∏¥‡πà‡∏á + ‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£)</h3>
      <div class="grid md:grid-cols-2 gap-3 text-sm">
        <input id="m_title" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤" class="px-3 py-2 border rounded">
        <input id="m_img" placeholder="‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡πÄ‡∏°‡∏ô‡∏π (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ 1200√ó600)" class="px-3 py-2 border rounded">
        <button id="btnAddMenu" class="px-4 py-2 bg-emerald-600 text-white rounded">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π</button>
        <button id="btnClearMenu" class="px-4 py-2 border rounded">‡∏•‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
      </div>
      <div id="menuList" class="mt-3 text-sm grid md:grid-cols-2 gap-2"></div>
    </div>
  </section>

  <!-- Floating Chat Button (mobile) -->
  <a id="fabChat" class="fixed bottom-4 right-4 z-50 px-4 py-3 rounded-full shadow-lg bg-emerald-600 text-white text-sm md:hidden">‡πÅ‡∏ä‡∏ï LINE</a>

  <!-- Backdrop + Drawer -->
  <div id="backdrop" class="backdrop"></div>
  <aside id="cartDrawer" class="drawer" aria-hidden="true">
    <div class="px-4 py-3 border-b flex items-center justify-between">
      <h3 class="font-semibold">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
      <button id="closeCart" class="text-gray-500 hover:text-gray-800">‚úï</button>
    </div>
    <div id="cartList" class="flex-1 overflow-auto divide-y"></div>
    <div class="border-t p-4 space-y-2">
      <div class="flex items-center justify-between text-sm">
        <span class="text-gray-600">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</span>
        <strong id="cartTotal" class="text-lg">‡∏ø0</strong>
      </div>
      <div class="flex gap-2">
        <button id="copyOrder" class="flex-1 px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>
        <button id="checkout" class="flex-1 px-3 py-2 rounded-xl bg-emerald-600 text-white text-sm hover:opacity-90">‡∏™‡πà‡∏á‡∏ó‡∏≤‡∏á LINE</button>
      </div>
      <button id="clearCart" class="w-full px-3 py-2 rounded-xl border text-sm hover:bg-gray-50">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
    </div>
  </aside>

  <script>
    // ======= CONFIG =======
    const STORE_NAME = '‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢ ‡∏ö‡πâ‡∏≤‡∏ô‡∏î‡∏≠‡∏ô‡∏Ç‡∏µ';
    const LINE_ID = '@906dooke'; // ‡πÉ‡∏™‡πà @ ‡πÑ‡∏î‡πâ ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß encode ‡πÉ‡∏´‡πâ
    const OA_ID_ENC = encodeURIComponent(LINE_ID);
    const lineChatUrl = (text='') => `https://line.me/R/oaMessage/${OA_ID_ENC}/?text=${encodeURIComponent(text)}`;

    // üîê PIN ‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô (‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ)
    const ADMIN_PIN = '2468';

    // ‡∏≠‡πà‡∏≤‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å GitHub RAW .txt
    const RAW_TXT_URL = 'https://raw.githubusercontent.com/sutisukkawaguji-spec/maenoi-grocery/main/data/products.txt';

    // ======= GLOBAL STATE =======
    let PRODUCTS = []; // ‡∏à‡∏≤‡∏Å GitHub
    let state = { q:'', category:'', min:'', max:'', onlyFeatured:false };
    let cart = JSON.parse(localStorage.getItem('cart') || '{}'); // { [id]: qty }

    // ======= LOCAL STORAGE KEYS =======
    const LS_LOCAL_PRODUCTS = 'local_products_v1';
    const LS_OVERRIDES     = 'product_overrides_v1'; // {id: {active:true/false, featured:true/false}}
    const LS_DAILY_MENU    = 'daily_menu_v1';

    // ======= HELPERS =======
    const $ = sel => document.querySelector(sel);
    function readJSON(key, fallback){ try{ return JSON.parse(localStorage.getItem(key) || JSON.stringify(fallback)); }catch{ return fallback; } }
    function writeJSON(key, val){ localStorage.setItem(key, JSON.stringify(val)); }
    const fmtBaht = n => new Intl.NumberFormat('th-TH', { style: 'currency', currency: 'THB', maximumFractionDigits: 0 }).format(n);

    function normalizeId(x){ return String(x ?? '').trim(); }

    function mergedProducts(){
      const locals = readJSON(LS_LOCAL_PRODUCTS, []);
      const overrides = readJSON(LS_OVERRIDES, {});
      const map = new Map();
      // ‡∏à‡∏≤‡∏Å GitHub
      for(const p of PRODUCTS){
        const o = overrides[normalizeId(p.id)] || {};
        map.set(normalizeId(p.id), { ...p, id: normalizeId(p.id), active: o.active !== false, featured: !!o.featured, _locked:true });
      }
      // ‡∏à‡∏≤‡∏Å Local
      for(const p of locals){
        const o = overrides[normalizeId(p.id)] || {};
        map.set(normalizeId(p.id), { ...p, id: normalizeId(p.id), active: o.active !== false, featured: !!o.featured, _locked:false });
      }
      return Array.from(map.values());
    }

    function getVisibleItems(){
      let items = mergedProducts().filter(i => i.active !== false);
      if(state.onlyFeatured) items = items.filter(i => i.featured);
      return items;
    }

    function uniqueCategories(items){
      return Array.from(new Set(items.map(i => i.category).filter(Boolean))).sort((a,b)=>String(a).localeCompare(String(b),'th'));
    }

    function filterItems(items){
      const q = state.q.trim().toLowerCase();
      const c = state.category;
      const min = state.min === '' ? -Infinity : Number(state.min);
      const max = state.max === '' ? Infinity : Number(state.max);
      return items.filter(it => {
        const okQ = !q || String(it.name).toLowerCase().includes(q);
        const okC = !c || String(it.category) === c;
        const okP = Number(it.price) >= min && Number(it.price) <= max;
        return okQ && okC && okP;
      });
    }

    function renderCategories(){
      const sel = document.getElementById('categorySelect');
      if(!sel) return;
      sel.innerHTML = '<option value="">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>';
      uniqueCategories(mergedProducts()).forEach(cat => {
        const opt = document.createElement('option');
        opt.value = cat; opt.textContent = cat; sel.appendChild(opt);
      });
    }

    function persistCart(){ localStorage.setItem('cart', JSON.stringify(cart)); }
    function cartCount(){ return Object.values(cart).reduce((a,b)=>a+(Number(b)||0),0); }
    function updateBadge(){ const el = document.getElementById('cartBadge'); if(el) el.textContent = cartCount(); }

    function findProduct(id){
      const idStr = normalizeId(id);
      return mergedProducts().find(p => normalizeId(p.id) === idStr) || PRODUCTS.find(p => normalizeId(p.id) === idStr);
    }

    function cartTotal(){
      return Object.entries(cart).reduce((sum,[id,qty]) => {
        const p = findProduct(id); if(!p) return sum;
        return sum + (Number(p.price)||0) * (Number(qty)||0);
      }, 0);
    }

    // ======= RENDER GRID =======
    function renderGrid(items){
      const wrap = document.getElementById('productGrid');
      if(!wrap) return;
      wrap.innerHTML = '';
      document.getElementById('resultCount').textContent = items.length;
      if(items.length === 0){
        wrap.innerHTML = '<div class="col-span-full text-center text-gray-500 py-10">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤</div>';
        return;
      }
      const frag = document.createDocumentFragment();
      items.forEach(it => {
        const el = document.createElement('article');
        el.className = 'card bg-white border border-gray-200 rounded-2xl overflow-hidden shadow-sm transition-all';
        el.innerHTML = `
          <div class="aspect-[4/3] bg-gray-100 overflow-hidden">
            <img src="${it.img}" alt="${it.name}" class="w-full h-full object-cover" loading="lazy" width="800" height="600" />
          </div>
          <div class="p-3">
            <h3 class="text-sm font-semibold leading-tight">${it.name}</h3>
            <div class="mt-1 flex items-center justify-between">
              <span class="inline-flex items-center px-2 py-1 rounded-lg bg-emerald-50 text-emerald-700 text-xs font-medium">${fmtBaht(it.price)} / ${it.unit || '-'}</span>
              <span class="text-xs text-gray-500">${it.category || '-'}</span>
            </div>
            <div class="mt-2 flex items-center gap-2">
              ${it.featured ? '<span class="text-[10px] px-2 py-0.5 rounded bg-yellow-100 text-yellow-800">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</span>' : ''}
              ${it._locked ? '<span title="‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå GitHub" class="text-[10px] px-2 py-0.5 rounded bg-gray-100 text-gray-600">üîí</span>' : ''}
            </div>
            <div class="mt-3 grid grid-cols-2 gap-2">
              <button class="btn-add w-full px-3 py-2 rounded-xl bg-emerald-600 text-white text-sm hover:opacity-90" data-id="${it.id}">‡∏´‡∏¢‡∏¥‡∏ö‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
              <button class="btn-chat w-full px-3 py-2 rounded-xl border text-sm hover:bg-gray-50" data-id="${it.id}">‡πÅ‡∏ä‡∏ï‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ</button>
            </div>
          </div>`;
        frag.appendChild(el);
      });
      wrap.appendChild(frag);
    }

    // ======= CART RENDER =======
    function renderCart(){
      const list = document.getElementById('cartList');
      if(!list) return;
      list.innerHTML = '';
      const entries = Object.entries(cart);
      if(entries.length === 0){
        list.innerHTML = '<div class="p-4 text-center text-gray-500">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á</div>';
      } else {
        entries.forEach(([id, qty]) => {
          const p = findProduct(id); if(!p) return;
          const row = document.createElement('div');
          row.className = 'p-3 flex items-center gap-3';
          row.innerHTML = `
            <img src="${p.img}" alt="${p.name}" class="w-16 h-12 object-cover rounded-md border">
            <div class="flex-1">
              <div class="text-sm font-semibold">${p.name}</div>
              <div class="text-xs text-gray-500">${fmtBaht(p.price)} / ${p.unit || '-'}</div>
            </div>
            <div class="flex items-center gap-2">
              <button class="btn-dec px-2 py-1 rounded-lg border" data-id="${id}">-</button>
              <span class="w-8 text-center">${qty}</span>
              <button class="btn-inc px-2 py-1 rounded-lg border" data-id="${id}">+</button>
            </div>
            <div class="w-20 text-right font-medium">${fmtBaht(p.price * qty)}</div>
          `;
          list.appendChild(row);
        });
      }
      document.getElementById('cartTotal').textContent = fmtBaht(cartTotal());
    }

    function buildOrderText(){
      const lines = ['‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö: ' + STORE_NAME, ''];
      Object.entries(cart).forEach(([id, qty]) => {
        const p = findProduct(id); if(!p) return;
        lines.push(`- ${p.name} x ${qty} (${fmtBaht(p.price)} / ${p.unit || '-'}) = ${fmtBaht(p.price*qty)}`);
      });
      lines.push('');
      lines.push('‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ' + fmtBaht(cartTotal()));
      lines.push('‡∏Ç‡∏≠‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á/‡∏ô‡∏±‡∏î‡∏£‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö');
      return lines.join('\n');
    }

    async function copyOrderToClipboard(){
      try{
        await navigator.clipboard.writeText(buildOrderText());
        alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏õ‡πÅ‡∏õ‡∏∞‡πÉ‡∏ô LINE ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢');
      }catch(e){
        const textarea = document.createElement('textarea');
        textarea.value = buildOrderText();
        document.body.appendChild(textarea);
        textarea.select(); document.execCommand('copy'); document.body.removeChild(textarea);
        alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏õ‡πÅ‡∏õ‡∏∞‡πÉ‡∏ô LINE ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢');
      }
    }

    function checkout(){
      window.open(lineChatUrl(buildOrderText()), '_blank');
    }

    function openCart(){ document.getElementById('cartDrawer').classList.add('open'); document.getElementById('backdrop').classList.add('show'); renderCart(); }
    function closeCart(){ document.getElementById('cartDrawer').classList.remove('open'); document.getElementById('backdrop').classList.remove('show'); }

    function refreshUI(){
      renderCategories();
      renderGrid(filterItems(getVisibleItems()));
      updateBadge();
    }

    // ====== LOAD PRODUCTS FROM GITHUB TXT ======
    function parseLinesAuto(text){
      const clean = text.replace(/^\uFEFF/, "");
      const lines = clean.split(/\r?\n/).map(l => l.trim()).filter(Boolean);
      const first = lines[0] || "";
      const commaCnt = (first.match(/,/g) || []).length;
      const tabCnt   = (first.match(/\t/g) || []).length;

      if (typeof Papa !== "undefined") {
        const tryPapa = (delimiter) => {
          const { data } = Papa.parse(clean, {
            delimiter, skipEmptyLines: true,
            transform: v => (v ?? "").toString().trim()
          });
          return data.filter(r => Array.isArray(r) && r.length >= 5);
        };
        const primary = (commaCnt >= tabCnt) ? "," : "\t";
        let rows = tryPapa(primary);
        if (!rows.length) rows = tryPapa(primary === "," ? "\t" : ",");
        return rows;
      }
      const useComma = commaCnt >= tabCnt;
      return lines.map(line => line.split(useComma ? "," : "\t").map(s => s.trim()));
    }

    function toItem(cols, idx){
      const [idRaw, name, priceRaw, unit, category, img] = cols.map(v => (v ?? "").toString().trim());
      const id = idRaw || String(idx+1);
      const price = Number((priceRaw || "").replace(/[^\d.]/g, ""));
      return {
        id: String(id),
        name,
        price: Number.isFinite(price) ? price : 0,
        unit,
        category,
        img: img || "images/placeholder.png",
        stock: 0
      };
    }

    async function loadProductsFromGitHubTxt(url = RAW_TXT_URL){
      try{
        if (location.protocol === 'file:') {
          $('#productGrid').innerHTML = '<div class="col-span-full text-center text-red-500 py-10">‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô http(s) (‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô file://)</div>';
          return;
        }
        const res = await fetch(`${url}?_=${Date.now()}`, { cache: "no-store" });
        if(!res.ok) throw new Error(`HTTP ${res.status}`);
        const text = await res.text();
        const rows = parseLinesAuto(text);
        PRODUCTS = rows.map(toItem);
        refreshUI();
      }catch(err){
        console.error("‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:", err);
        $('#productGrid').innerHTML = '<div class="col-span-full text-center text-red-500 py-10">‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å GitHub ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>';
      }
    }

    // ===== ADMIN: OVERRIDES & LOCAL =====
    function setOverride(id, patch){
      const ov = readJSON(LS_OVERRIDES, {});
      ov[normalizeId(id)] = { ...(ov[normalizeId(id)]||{}), ...patch };
      writeJSON(LS_OVERRIDES, ov);
    }

    function openAdminPanel(){ document.getElementById('adminPanel').classList.remove('hidden'); renderAdmin(); }
    function closeAdminPanel(){ document.getElementById('adminPanel').classList.add('hidden'); }

    function renderAdmin(){
      // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
      const list = document.getElementById('adminList');
      const items = mergedProducts().sort((a,b)=>String(a.name).localeCompare(String(b.name),'th'));
      list.innerHTML = '';
      for(const p of items){
        const row = document.createElement('div');
        row.className = 'flex items-center gap-2';
        row.innerHTML = `
          <span class="w-6 text-xs ${p._locked ? 'opacity-60' : ''}">${p._locked ? 'üîí' : ''}</span>
          <img src="${p.img}" class="w-10 h-8 object-cover rounded border">
          <div class="flex-1">
            <div class="font-medium">${p.name}</div>
            <div class="text-xs text-gray-500">${p.category || '-'} ‚Ä¢ ${p.unit||'-'} ‚Ä¢ ‡∏ø${p.price}</div>
          </div>
          <button class="px-2 py-1 border rounded text-xs ${p.active!==false?'bg-emerald-50':''}" data-act="toggle" data-id="${p.id}">
            ${p.active!==false ? '‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏¢‡∏π‡πà' : '‡∏õ‡∏¥‡∏î'}
          </button>
          <button class="px-2 py-1 border rounded text-xs ${p.featured?'bg-yellow-50':''}" data-act="feat" data-id="${p.id}">
            ${p.featured?'‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‚úì':'‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥'}
          </button>
          ${p._locked ? '' : `<button class="px-2 py-1 border rounded text-xs" data-act="del" data-id="${p.id}">‡∏•‡∏ö</button>`}
        `;
        list.appendChild(row);
      }

      // ‡πÄ‡∏°‡∏ô‡∏π‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
      const menus = readJSON(LS_DAILY_MENU, []);
      const wrap = document.getElementById('menuList'); wrap.innerHTML='';
      menus.forEach((m,i)=>{
        const el = document.createElement('div');
        el.className='border rounded p-2 flex items-center gap-2';
        el.innerHTML = `
          <img src="${m.img}" class="w-16 h-12 object-cover rounded">
          <div class="flex-1"><div class="text-sm font-medium">${m.title}</div></div>
          <button class="px-2 py-1 border rounded text-xs" data-mi="${i}" data-act="up">‡∏Ç‡∏∂‡πâ‡∏ô</button>
          <button class="px-2 py-1 border rounded text-xs" data-mi="${i}" data-act="down">‡∏•‡∏á</button>
          <button class="px-2 py-1 border rounded text-xs" data-mi="${i}" data-act="rm">‡∏•‡∏ö</button>
        `;
        wrap.appendChild(el);
      });
    }

    function renderDailyMenu(){
      const data = readJSON(LS_DAILY_MENU, []);
      const track = document.getElementById('menuTrack'); if(!track) return;
      if(!data.length){
        track.innerHTML = '<div class="w-full text-center text-gray-500 py-8">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏°‡∏ô‡∏π‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>';
        return;
      }
      track.innerHTML = data.map(m => `
        <figure class="relative w-full flex-shrink-0">
          <img src="${m.img}" alt="${m.title}" class="w-full h-56 md:h-72 object-cover">
          <figcaption class="absolute bottom-2 left-2 right-2 bg-black/50 text-white text-sm md:text-base px-3 py-1 rounded">${m.title}</figcaption>
        </figure>
      `).join('');
      Array.from(track.children).forEach(el=> el.style.width='100%');
      let i=0; const total=data.length;
      setInterval(()=>{ i=(i+1)%total; track.style.transform=`translateX(-${i*100}%)`; }, 3500);
    }

    // ===== INIT =====
    document.addEventListener('DOMContentLoaded', () => {
      const y = document.getElementById('y'); if (y) y.textContent = new Date().getFullYear();

      // ‡∏ï‡∏±‡πâ‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå LINE
      const msg = '‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤';
      const lineURL = lineChatUrl(msg);
      const setHref = (id, u) => { const el = document.getElementById(id); if (el) el.href = u; };
      setHref('lineLink', lineURL);
      setHref('fabChat', lineURL);
      setHref('lineLinkFooter', lineURL);

      // ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ + ‡πÄ‡∏°‡∏ô‡∏π‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
      const grid = document.getElementById('productGrid');
      if (grid) grid.innerHTML = '<div class="col-span-full text-center text-gray-500 py-10">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤...</div>';
      loadProductsFromGitHubTxt();
      renderDailyMenu();
      updateBadge();

      // ‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå
      document.getElementById('searchInput').addEventListener('input', e => { state.q = e.target.value; renderGrid(filterItems(getVisibleItems())); });
      document.getElementById('categorySelect').addEventListener('change', e => { state.category = e.target.value; renderGrid(filterItems(getVisibleItems())); });
      document.getElementById('minPrice').addEventListener('input', e => { state.min = e.target.value; renderGrid(filterItems(getVisibleItems())); });
      document.getElementById('maxPrice').addEventListener('input', e => { state.max = e.target.value; renderGrid(filterItems(getVisibleItems())); });
      document.getElementById('onlyFeatured').addEventListener('change', e => { state.onlyFeatured = e.target.checked; renderGrid(filterItems(getVisibleItems())); });

      document.getElementById('clearFilters').addEventListener('click', () => {
        state = { q:'', category:'', min:'', max:'', onlyFeatured:false };
        document.getElementById('searchInput').value = '';
        document.getElementById('categorySelect').value = '';
        document.getElementById('minPrice').value = '';
        document.getElementById('maxPrice').value = '';
        document.getElementById('onlyFeatured').checked = false;
        renderGrid(filterItems(getVisibleItems()));
      });

      // ‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô‡∏Å‡∏£‡∏¥‡∏î
      document.getElementById('productGrid').addEventListener('click', (e) => {
        const addBtn = e.target.closest('.btn-add');
        const chatBtn = e.target.closest('.btn-chat');
        if (addBtn) {
          const id = normalizeId(addBtn.getAttribute('data-id'));
          cart[id] = (cart[id] || 0) + 1;
          persistCart(); updateBadge();
        }
        if (chatBtn) {
          const id = normalizeId(chatBtn.getAttribute('data-id'));
          const p = findProduct(id); if(!p) return;
          const text = `‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: ${p.name} 1 ${p.unit||''} ‡∏£‡∏≤‡∏Ñ‡∏≤ ${fmtBaht(p.price)}`;
          window.open(lineChatUrl(text), '_blank');
        }
      });

      // ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
      document.getElementById('openCart').addEventListener('click', openCart);
      document.getElementById('closeCart').addEventListener('click', closeCart);
      document.getElementById('backdrop').addEventListener('click', closeCart);
      document.getElementById('clearCart').addEventListener('click', () => { cart = {}; persistCart(); renderCart(); updateBadge(); });
      document.getElementById('copyOrder').addEventListener('click', copyOrderToClipboard);
      document.getElementById('checkout').addEventListener('click', checkout);

      // üîê ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏°‡∏î‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ (‡∏°‡∏µ PIN)
      const adminDialog = document.getElementById('adminAuth');
      document.body.insertAdjacentHTML('beforeend', '<button id="btnAdmin" class="fixed bottom-4 left-4 z-50 px-3 py-2 rounded-full border bg-white shadow">‚öôÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</button>');
      document.getElementById('btnAdmin').addEventListener('click', () => {
        document.getElementById('adminPinInput').value='';
        adminDialog.showModal();
      });
      document.getElementById('adminLoginBtn').addEventListener('click', () => {
        const pin = document.getElementById('adminPinInput').value.trim();
        if(pin === ADMIN_PIN){
          sessionStorage.setItem('admin_ok','1');
          adminDialog.close();
          openAdminPanel();
        } else {
          alert('‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
        }
      });

      // ‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
      document.getElementById('btnCloseAdmin').addEventListener('click', () => { closeAdminPanel(); });
      document.getElementById('btnExport').addEventListener('click', ()=>{
        const blob = new Blob([JSON.stringify({
          local_products: readJSON(LS_LOCAL_PRODUCTS, []),
          overrides: readJSON(LS_OVERRIDES, {}),
          daily_menu: readJSON(LS_DAILY_MENU, [])
        }, null, 2)], {type:'application/json'});
        const a = Object.assign(document.createElement('a'), { href: URL.createObjectURL(blob), download: 'maenoi-export.json' });
        a.click(); URL.revokeObjectURL(a.href);
      });
      document.getElementById('importFile').addEventListener('change', async (e)=>{
        const file = e.target.files?.[0]; if(!file) return;
        const data = JSON.parse(await file.text());
        if(data.local_products) writeJSON(LS_LOCAL_PRODUCTS, data.local_products);
        if(data.overrides) writeJSON(LS_OVERRIDES, data.overrides);
        if(data.daily_menu) writeJSON(LS_DAILY_MENU, data.daily_menu);
        renderAdmin(); renderDailyMenu(); refreshUI();
      });

      // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
      document.getElementById('btnAddProduct').addEventListener('click', ()=>{
        const item = {
          id: (document.getElementById('p_id').value || Date.now()).toString(),
          name: document.getElementById('p_name').value.trim(),
          price: Number(document.getElementById('p_price').value || 0),
          unit: document.getElementById('p_unit').value.trim(),
          category: document.getElementById('p_cat').value.trim(),
          img: document.getElementById('p_img').value.trim() || 'images/cover.jpg',
          active: document.getElementById('p_active').checked,
          featured: document.getElementById('p_featured').checked,
          _locked:false
        };
        if(!item.name || !item.price){ alert('‡∏Å‡∏£‡∏≠‡∏Å ‡∏ä‡∏∑‡πà‡∏≠ ‡πÅ‡∏•‡∏∞ ‡∏£‡∏≤‡∏Ñ‡∏≤'); return; }
        const locals = readJSON(LS_LOCAL_PRODUCTS, []);
        const idx = locals.findIndex(x => normalizeId(x.id) === normalizeId(item.id));
        if(idx >= 0) locals[idx] = item; else locals.push(item);
        writeJSON(LS_LOCAL_PRODUCTS, locals);
        setOverride(item.id, { active:item.active, featured:item.featured });
        renderAdmin(); refreshUI();

        // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
        ['p_id','p_name','p_price','p_unit','p_cat','p_img'].forEach(id => { const el=document.getElementById(id); if(el) el.value=''; });
        document.getElementById('p_active').checked = true;
        document.getElementById('p_featured').checked = false;
      });

      // ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÉ‡∏ô‡∏•‡∏¥‡∏™‡∏ï‡πå‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
      document.getElementById('adminList').addEventListener('click', (e)=>{
        const btn = e.target.closest('button'); if(!btn) return;
        const id  = btn.dataset.id;
        const act = btn.dataset.act;
        if(act==='toggle'){ const cur = (readJSON(LS_OVERRIDES, {})[normalizeId(id)]?.active!==false); setOverride(id,{active:!cur}); }
        if(act==='feat'){ const cur = !!(readJSON(LS_OVERRIDES, {})[normalizeId(id)]?.featured); setOverride(id,{featured:!cur}); }
        if(act==='del'){
          const locals = readJSON(LS_LOCAL_PRODUCTS, []).filter(x=>normalizeId(x.id)!==normalizeId(id));
          writeJSON(LS_LOCAL_PRODUCTS, locals);
        }
        renderAdmin(); refreshUI();
      });

      // ‡πÄ‡∏°‡∏ô‡∏π‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏¢‡πâ‡∏≤‡∏¢/‡∏•‡∏ö
      document.getElementById('btnAddMenu').addEventListener('click', ()=>{
        const m = { title: document.getElementById('m_title').value.trim(), img: document.getElementById('m_img').value.trim() };
        if(!m.title || !m.img) return alert('‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏•‡∏∞‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ');
        const arr = readJSON(LS_DAILY_MENU, []); arr.push(m); writeJSON(LS_DAILY_MENU, arr);
        document.getElementById('m_title').value=''; document.getElementById('m_img').value='';
        renderAdmin(); renderDailyMenu();
      });
      document.getElementById('btnClearMenu').addEventListener('click', ()=>{ writeJSON(LS_DAILY_MENU, []); renderAdmin(); renderDailyMenu(); });
      document.getElementById('menuList').addEventListener('click', (e)=>{
        const b=e.target.closest('button'); if(!b) return;
        const i=Number(b.dataset.mi); const act=b.dataset.act;
        const arr=readJSON(LS_DAILY_MENU, []);
        if(act==='rm') arr.splice(i,1);
        if(act==='up' && i>0) [arr[i-1],arr[i]]=[arr[i],arr[i-1]];
        if(act==='down' && i<arr.length-1) [arr[i+1],arr[i]]=[arr[i],arr[i+1]];
        writeJSON(LS_DAILY_MENU, arr); renderAdmin(); renderDailyMenu();
      });
    });
  </script>
</body>
</html>
